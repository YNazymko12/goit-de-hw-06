# –î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è –¥–æ —Ç–µ–º–∏ ¬´Spark streaming¬ª

–í—ñ—Ç–∞—é! –Ø–∫ –Ω–∞—Å—Ç—Äi–π? –°–ø–æ–¥i–≤–∞—é—Å—å, —â–æ –≤–∏ –∑ –Ω–µ—Ç–µ—Ä–øi–Ω–Ω—è–º –æ—á—ñ–∫—É—î—Ç–µ –Ω–∞ –Ω–æ–≤–∏–π —á–µ–ª–µ–Ω–¥–∂ üòâ

–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—à—É –¥–æ –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è, –≤–∏–∫–æ–Ω–∞–≤—à–∏ —è–∫–µ, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–∏—Ç–∏
—Å–≤–æ—ó –Ω–∞–≤–∏—á–∫–∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è Apache Kafka.

–ó–∞–≤–¥–∞–Ω–Ω—è —î —Å—Ö–æ–∂–∏–º –Ω–∞ —Ç–µ, —â–æ –±—É–ª–æ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ç–µ–º—ñ, –∞–ª–µ –Ω–∞–±–∞–≥–∞—Ç–æ —Ü—ñ–∫–∞–≤—ñ—à–µ! üòä

–°—å–æ–≥–æ–¥–Ω—ñ –≤–∏ –±—É–¥–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ç–∏–ø–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∑–Ω–∞—á–µ–Ω—å –¥–∞–Ω–∏—Ö –Üo–¢
–ø—Ä–∏–ª–∞–¥—ñ–≤.

–£ —Ü—å–æ–º—É –¥–æ–º–∞—à–Ω—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –≤–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–ª—è –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö –∑ Kafka-—Ç–æ–ø—ñ–∫—É, —â–æ
–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è —Å–µ–Ω—Å–æ—Ä–∞–º–∏, —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É, —â–æ –±—É–¥–µ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ —Ç–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏
–∞–ª–µ—Ä—Ç–∏ –≤ alert-Kafka-—Ç–æ–ø—ñ–∫ –∑–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤.

> [!NOTE]
>
> üëì –ê–ª–µ—Ä—Ç ‚Äî –≤—ñ–¥ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ–≥–æ —Å–ª–æ–≤–∞ alert ‚Äî —Ç—Ä–∏–≤–æ–≥–∞. –î–∞–Ω—ñ, —â–æ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –º–µ–∂—ñ
> –¥–æ–ø—É—Å—Ç–∏–º–∏—Ö –∑–Ω–∞—á–µ–Ω—å, –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è –∞–ª–µ—Ä—Ç–∞–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —á–∏
> –≤–æ–ª–æ–≥—ñ—Å—Ç—å –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –¥–æ–ø—É—Å—Ç–∏–º—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.

## –ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

#### 1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö:

–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ ‚Äî —Ü–µ –¥–∞–Ω—ñ –∑ Kafka-—Ç–æ–ø—ñ–∫—É, —Ç–∞–∫—ñ —Å–∞–º—ñ, —è–∫ —ñ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –¥–æ–º–∞—à–Ω—å–æ–º—É
–∑–∞–≤–¥–∞–Ω–Ω—ñ. –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö, —â–æ –º—ñ—Å—Ç–∏—Ç—å `id`, `temperature`, `humidity`,
`timestamp` . –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ä–∞–Ω—ñ—à–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–π –≤–∞–º–∏ —Å–∫—Ä–∏–ø—Ç —Ç–∞ —Ç–æ–ø—ñ–∫.

#### 2. –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö:

–ó—á–∏—Ç–∞–π—Ç–µ –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö, —â–æ –≤–∏ –∑–≥–µ–Ω–µ—Ä—É–≤–∞–ª–∏ –≤ –ø–µ—Ä—à–æ–º—É –ø—É–Ω–∫—Ç—ñ. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Sliding
window, —â–æ –º–∞—î –¥–æ–≤–∂–∏–Ω—É 1 —Ö–≤–∏–ª–∏–Ω—É, sliding_interval ‚Äî 30 —Å–µ–∫—É–Ω–¥, —Ç–∞ watermark
duration ‚Äî 10 —Å–µ–∫—É–Ω–¥, –∑–Ω–∞–π–¥—ñ—Ç—å —Å–µ—Ä–µ–¥–Ω—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ç–∞ –≤–æ–ª–æ–≥—ñ—Å—Ç—å.

#### 3. –ó–Ω–∞–π–æ–º—Å—Ç–≤–æ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∞–ª–µ—Ä—Ç—ñ–≤:

–í–∞—à –Ω–∞—á–∞–ª—å–Ω–∏–∫ –ª—é–±–∏—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó –∞–ª–µ—Ä—Ç—ñ–≤. –¢–æ–º—É, —â–æ–± –¥–µ–ø–ª–æ—ó—Ç–∏ –∫–æ–¥ –∫–æ–∂–Ω–æ–≥–æ
—Ä–∞–∑—É, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–ª–µ—Ä—Ç—ñ–≤ –≤–∫–∞–∑–∞–Ω—ñ –≤ —Ñ–∞–π–ª—ñ:

alerts_conditions.csv

–§–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ —Ç–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ –π –≤–æ–ª–æ–≥–æ—Å—Ç—ñ,
–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ –∫–æ–¥ –∞–ª–µ—Ä—Ç—É. –ó–Ω–∞—á–µ–Ω–Ω—è `-999,-999` –≤–∫–∞–∑—É—é—Ç—å, —â–æ –≤–æ–Ω–∏ –Ω–µ
–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ü—å–æ–≥–æ –∞–ª–µ—Ä—Ç—É.

–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ –¥–∞–Ω—ñ –≤ —Ñ–∞–π–ª—ñ. –í–æ–Ω–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —ñ–Ω—Ç—É—ó—Ç–∏–≤–Ω–æ –∑—Ä–æ–∑—É–º—ñ–ª—ñ. –í–∏ –º–∞—î—Ç–µ
–∑—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ñ–∞–π–ª—É —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤.

#### 4. –ü–æ–±—É–¥–æ–≤–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤:

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –≤–∏ –∑–Ω–∞–π—à–ª–∏ —Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏, —á–∏ –ø—ñ–¥–ø–∞–¥–∞—é—Ç—å
–≤–æ–Ω–∏ –ø—ñ–¥ –∫—Ä–∏—Ç–µ—Ä—ñ—ó —É —Ñ–∞–π–ª—ñ (–ø—ñ–¥–∫–∞–∑–∫–∞: –≤–∏–∫–æ–Ω–∞–π—Ç–µ cross join —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é).

#### 5. –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É Kafka-—Ç–æ–ø—ñ–∫:

–û—Ç—Ä–∏–º–∞–Ω—ñ –∞–ª–µ—Ä—Ç–∏ –∑–∞–ø–∏—à—ñ—Ç—å —É –≤–∏—Ö—ñ–¥–Ω–∏–π Kafka-—Ç–æ–ø—ñ–∫.

## –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ç–∞ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –î–ó

> [!TIP]
>
> ‚òùüèª –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è —î –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ—é —É–º–æ–≤–æ—é —Ä–æ–∑–≥–ª—è–¥—É
> –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –º–µ–Ω—Ç–æ—Ä–æ–º. –Ø–∫—â–æ —è–∫–∏–π—Å—å –∑ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–æ, –î–ó
> –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –º–µ–Ω—Ç–æ—Ä–æ–º –Ω–∞ –¥–æ–æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è –±–µ–∑ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è. –Ø–∫—â–æ –≤–∞–º ¬´—Ç—ñ–ª—å–∫–∏
> —É—Ç–æ—á–Ω–∏—Ç–∏¬ªüòâ –∞–±–æ –≤–∏ ¬´–∑–∞—Å—Ç–æ–ø–æ—Ä–∏–ª–∏—Å—è¬ª –Ω–∞ —è–∫–æ–º—É—Å—å –∑ –µ—Ç–∞–ø—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è ‚Äî –∑–≤–µ—Ä—Ç–∞–π—Ç–µ—Å—è
> –¥–æ –º–µ–Ω—Ç–æ—Ä–∞ —É Slack).

1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö —Å–µ–Ω—Å–æ—Ä—ñ–≤.

2. –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤.

3. –ü–æ–±—É–¥–æ–≤–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ –º–µ—Ö–∞–Ω—ñ–∑–º—É, —â–æ –≤–∏–∑–Ω–∞—á–∏—Ç—å, —è–∫—ñ –∑–∞–ø–∏—Å–∏ —î –∞–ª–µ—Ä—Ç–∞–º–∏.

4. –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É Kafka-—Ç–æ–ø—ñ–∫.

### –§–æ—Ä–º–∞—Ç –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è ‚Äî –∑–∞–ª—ñ–∫/–Ω–µ–∑–∞–ª—ñ–∫.

–°—Ç—É–¥–µ–Ω—Ç –æ—Ç—Ä–∏–º—É—î –æ—Ü—ñ–Ω–∫—É ¬´–∑–∞–ª—ñ–∫¬ª –∑–∞ —É–º–æ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö –≤–∏—â–µ–∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤
–ø—Ä–∏–π–Ω—è—Ç—Ç—è –Ω–∞ –±–∞–∑–æ–≤–æ–º—É —Ä—ñ–≤–Ω—ñ.

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –ø—É–±–ª—ñ—á–Ω–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π `goit-de-hw-06`.

2. –í–∏–∫–æ–Ω–∞–π—Ç–µ –∑–∞–≤–¥–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤—Ç–µ —É —Å–≤—ñ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —Å–∫—Ä–∏–Ω—à–æ—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è
   –∫–æ–∂–Ω–æ–≥–æ –∑ –µ—Ç–∞–ø—ñ–≤ —É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—ñ –∑ –∫–æ—Ä–æ—Ç–∫–∏–º –æ–ø–∏—Å–æ–º –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è.

–ü–µ—Ä–µ–ª—ñ–∫ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç—ñ–≤:

- —Å–∫—Ä–∏–Ω –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö —Å–µ–Ω—Å–æ—Ä—ñ–≤ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö –≤ `building_sensors` –∑
  –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—î—é –¥–≤–æ—Ö (–∞–±–æ –±—ñ–ª—å—à–µ) –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö —Ä–æ–±–æ—Ç–∏ –¥–≤–æ—Ö –∑–∞–ø—É—Å–∫—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–∏;

- —Å–∫—Ä–∏–Ω –∑ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—î—é —Ç–æ–≥–æ, —â–æ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –±—É–ª–∏ –ø–æ—Å–ª–∞–Ω—ñ —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ
  —Ç–æ–ø—ñ–∫–∏.

3. –°—Ç–≤–æ—Ä—ñ—Ç—å –æ–¥–∏–Ω –∞—Ä—Ö—ñ–≤, —â–æ –º—ñ—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è, —Ç–∞ —Ç–∞ —Ç–µ–∫—Å—Ç–æ–≤–∏–π
   –¥–æ–∫—É–º–µ–Ω—Ç —ñ–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏, –ø—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å –π–æ–≥–æ –≤ LMS. –ù–∞–∑–≤–∞ –∞—Ä—Ö—ñ–≤—É –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ —É
   —Ñ–æ—Ä–º–∞—Ç—ñ –î–ó6\*–ü–Ü–ë.

4. –ü—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π `goit-de-hw-06` —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤—Ç–µ –Ω–∞
   –ø–µ—Ä–µ–≤—ñ—Ä–∫—É.

## –§–æ—Ä–º–∞—Ç –∑–¥–∞—á—ñ

- –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π `goit-de-hw-06`.
- –ü—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –∞—Ä—Ö—ñ–≤ —ñ–∑ –Ω–∞–∑–≤–æ—é –î–ó6_–ü–Ü–ë.

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω–Ω—å

![Results](./assets/screen_1.png)

![Results](./assets/screen_2.png)

![Results](./assets/screen_3.png)
